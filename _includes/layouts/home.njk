---
layout: layouts/base.njk
---

{% macro renderNav(items) %}
  <ul class="list pl0 ma0 pa0 flex flex-column lh-copy items-end">
    {% for item in items %}
      <li class="mb2 w-100">
        <a href="{{ item.url }}"
           class="db pa3 link dim f5 lh-copy tr tl-ns theme-text">
          {{ item.data.title }}
        </a>
        {% if item.children %}
          {{ renderNav(item.children) }}
        {% endif %}
      </li>
    {% endfor %}
  </ul>
{% endmacro %}

{% set siteThemeConfig = site.theme or {} %}
{% set showThemeSelectors = siteThemeConfig.showSelectors if siteThemeConfig.showSelectors is defined else true %}

<div class="sans-serif">
  <style>
    /* Fade + Slide Keyframe Animations */
    @keyframes slideFadeIn {
      from { transform: translateY(-10px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    @keyframes slideFadeOut {
      from { transform: translateY(0); opacity: 1; }
      to { transform: translateY(-10px); opacity: 0; }
    }
    .slide-fade-in { animation: slideFadeIn 0.3s ease forwards; }
    .slide-fade-out { animation: slideFadeOut 0.3s ease forwards; }

    /* Burger Menu Icon */
    #nav-toggle { position: relative; width: 2rem; height: 2rem; }
    .burger {
      position: absolute;
      top: 50%; left: 50%;
      width: 1.5rem; height: 1.25rem;
      transform: translate(-50%, -50%);
      display: flex; flex-direction: column;
      justify-content: space-between;
    }
    .burger div {
      width: 100%; height: 2px;
      background: #000;
      transition: transform 0.3s ease, opacity 0.3s ease, width 0.3s ease;
    }
    /* active state: hide middle patty, rotate buns */
    #nav-toggle.opened .burger .patty {
      opacity: 0;
    }
    #nav-toggle.opened .burger .top-bun {
      transform: translateY(6px) rotate(45deg);
      width: 100%;
    }
    #nav-toggle.opened .burger .bottom-bun {
      transform: translateY(-6px) rotate(-45deg);
      width: 100%;
    }

    [data-theme-preview] {
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    [data-theme-preview]:focus {
      outline: none;
    }
    [data-theme-preview][data-active] {
      box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.35);
    }
    [data-theme-preview]:hover {
      transform: translateY(-2px);
    }

    .theme .theme-text,
    .theme .theme-text:visited,
    .theme .theme-text:hover,
    .theme .theme-text:focus,
    .theme .theme-text:active {
      color: inherit;
    }
  </style>

  <!-- Site Title + Mobile Hamburger -->
  <div class="pa4 flex items-center justify-between flex-wrap">
    <a href="/" class="link dim f3 f2-ns fw6 ma0 tr tl-ns db theme-text">
      {{ site.title }}
    </a>
    <div class="flex items-center mt3 mt0-ns flex-wrap justify-end">
      {% if showThemeSelectors %}
      <div class="flex items-center flex-wrap">
        {% for theme in themes %}
          <button type="button"
                  class="w2 h2 bn pointer br2 mr2 mb2 pa0 ba b--transparent bg-transparent flex items-center justify-center"
                  data-theme-preview="{{ theme.id }}"{% if loop.first %} data-active{% endif %}
                  aria-label="Preview {{ theme.label }} theme">
            <span class="w-100 h-100 br2 flex items-center justify-center {{ theme.classes | join(' ') }}">
              Aa
            </span>
          </button>
        {% endfor %}
      </div>
      {% endif %}
      <button id="nav-toggle" class="dib dn-ns bn bg-transparent pa2 pointer{% if showThemeSelectors %} ml3{% endif %} mt2 mt0-ns" aria-expanded="false" aria-controls="sidebar">
        <div class="burger">
          <div class="top-bun"></div>
          <div class="patty"></div>
          <div class="bottom-bun"></div>
        </div>
      </button>
    </div>
  </div>

  <!-- Two-column layout -->
  <div class="flex flex-column flex-row-ns">
    <!-- Sidebar nav: hidden on mobile until toggle; no background color -->
    <nav id="sidebar" class="dn db-ns w-100 w-25-ns pa4">
      {{ renderNav(collections.all | eleventyNavigation) }}
    </nav>

    <!-- Main content -->
    <main class="w-100 w-75-ns pa4 lh-copy">
      {% if showPostHeader %}
        <header class="mb4">
          {% if page.date %}
            <p class="f6 ttu tracked mid-gray mt0 mb2">
              <time datetime="{{ page.date | machineDate }}">{{ page.date | readableDate }}</time>
            </p>
          {% endif %}
          {% if title %}
            <h1 class="f2 lh-title mt0 mb3">{{ title }}</h1>
          {% endif %}
        </header>
      {% endif %}
      <heading-anchors>
        {{ content | safe }}
      </heading-anchors>
    </main>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const btn = document.getElementById('nav-toggle');
    const sidebar = document.getElementById('sidebar');

    btn.addEventListener('click', function() {
      const isOpen = btn.getAttribute('aria-expanded') === 'true';
      btn.setAttribute('aria-expanded', String(!isOpen));
      btn.classList.toggle('opened', !isOpen);

      if (!isOpen) {
        sidebar.classList.remove('dn', 'slide-fade-out');
        sidebar.classList.add('slide-fade-in');
      } else {
        sidebar.classList.remove('slide-fade-in');
        sidebar.classList.add('slide-fade-out');
        sidebar.addEventListener('animationend', function handler() {
          sidebar.classList.add('dn');
          sidebar.removeEventListener('animationend', handler);
        });
      }
    });
  });
</script>
